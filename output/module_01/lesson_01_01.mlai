<?xml version="1.0" encoding="UTF-8"?>
<Lesson>
  <Meta>
    <Id>lesson-01-01</Id>
    <Title>Dynamical Systems Framework for Neuroscience</Title>
    <Version>1</Version>
    <Tags>
      <Tag>dynamical-systems</Tag>
      <Tag>neuroscience</Tag>
      <Tag>attractors</Tag>
      <Tag>state-space</Tag>
      <Tag>differential-equations</Tag>
    </Tags>
  </Meta>

  <H1>Dynamical Systems Framework for Neuroscience</H1>

  <Body>Neuronal behavior can be precisely characterized as trajectories in state space, where understanding attractors and basins reveals how neurons respond to stimuli and return to rest. This lesson introduces the mathematical framework of dynamical systems theory as the foundation for all subsequent neuronal modeling.</Body>

  <H2>Learning Objectives</H2>

  <Body>By the end of this lesson, you will be able to define dynamical systems in the context of neuronal modeling, distinguish between deterministic and stochastic dynamical systems, identify fixed point attractors and their attractive basins in neuronal models, and relate these mathematical concepts to biological phenomena such as resting potential and firing patterns.</Body>

  <H2>Mathematical Definition of Dynamical Systems</H2>

  <Body>A dynamical system describes how a state evolves over time according to a fixed rule. In continuous time, we express this as an ordinary differential equation (ODE). The fundamental form is:</Body>

  <Code lang="plaintext">
dx/dt = f(x, t)
  </Code>

  <Body>Here, x represents the state vector (which could be a scalar or vector in higher dimensions), t represents time, and f is the vector field that determines the direction and magnitude of change at every point in state space. When f does not explicitly depend on time, we call the system autonomous:</Body>

  <Code lang="plaintext">
dx/dt = f(x)
  </Code>

  <Body>In neuroscience, the state variable x often represents the membrane potential V, and the vector field f encodes the biophysical mechanisms that govern voltage changes, such as ionic currents and synaptic inputs.</Body>

  <FlashCard id="fc1">
    <Front>What is a dynamical system?</Front>
    <Back>A mathematical description of how a state evolves over time according to a fixed rule, typically expressed as dx/dt = f(x, t) where x is the state, t is time, and f is the vector field determining the evolution.</Back>
  </FlashCard>

  <H2>State Space and Trajectories</H2>

  <Body>The state space (or phase space) is the set of all possible states a system can occupy. For a single neuron modeled by membrane potential alone, the state space is one-dimensional (the real line representing all possible voltage values). For more complex models with multiple variables, the state space becomes multi-dimensional.</Body>

  <Body>A trajectory is a curve in state space that represents the evolution of the system from a particular initial condition. Given an initial state x(0) = x_0, the trajectory is the function x(t) that satisfies the differential equation for all subsequent times. Different initial conditions generally produce different trajectories.</Body>

  <Code lang="python">
import numpy as np
import matplotlib.pyplot as plt

# Simple 1D example: exponential decay to resting potential
def simulate_trajectory(V0, V_rest, tau, t_max, dt):
    """Simulate dV/dt = -(V - V_rest)/tau from initial condition V0."""
    t = np.arange(0, t_max, dt)
    V = np.zeros_like(t)
    V[0] = V0

    for i in range(1, len(t)):
        dV = -(V[i-1] - V_rest) / tau
        V[i] = V[i-1] + dV * dt

    return t, V

# Parameters
V_rest = -70  # mV (resting potential)
tau = 10      # ms (membrane time constant)

# Simulate from different initial conditions
initial_conditions = [-90, -80, -70, -60, -50]  # mV

plt.figure(figsize=(10, 6))
for V0 in initial_conditions:
    t, V = simulate_trajectory(V0, V_rest, tau, t_max=50, dt=0.1)
    plt.plot(t, V, label=f'V(0) = {V0} mV')

plt.axhline(y=V_rest, color='k', linestyle='--', label='V_rest')
plt.xlabel('Time (ms)')
plt.ylabel('Membrane Potential (mV)')
plt.title('Trajectories Converging to Resting Potential')
plt.legend()
plt.grid(True)
plt.show()
  </Code>

  <Body>The code above demonstrates how trajectories from different initial conditions all converge to the same resting potential. This convergence behavior is the hallmark of a stable fixed point attractor.</Body>

  <FlashCard id="fc2">
    <Front>What is a trajectory in dynamical systems?</Front>
    <Back>A trajectory is a curve in state space representing the temporal evolution of the system from a specific initial condition. It is the solution x(t) to the differential equation starting from x(0) = x_0.</Back>
  </FlashCard>

  <H2>Deterministic vs. Stochastic Systems</H2>

  <Body>Dynamical systems can be classified as deterministic or stochastic based on whether randomness plays a role in their evolution.</Body>

  <H3>Deterministic Systems</H3>

  <Body>In a deterministic system, the future state is completely determined by the current state and the governing equations. Given the same initial condition, the system will always follow the same trajectory. The equations dx/dt = f(x) are deterministic: once you specify x(0), the entire future evolution is fixed.</Body>

  <H3>Stochastic Systems</H3>

  <Body>Real neurons are subject to various sources of noise: thermal fluctuations, random neurotransmitter release, ion channel stochasticity, and background synaptic input. Stochastic differential equations (SDEs) incorporate this randomness:</Body>

  <Code lang="plaintext">
dx = f(x)dt + g(x)dW
  </Code>

  <Body>Here, dW represents a Wiener process (Brownian motion), and g(x) scales the noise intensity. The term f(x)dt is the deterministic drift, while g(x)dW is the stochastic diffusion. Unlike deterministic systems, identical initial conditions can lead to different trajectories due to the random fluctuations.</Body>

  <Body>When does noise matter? Noise becomes functionally significant when it can push the system across thresholds (spontaneous firing), when it affects timing precision (spike timing variability), and when the deterministic dynamics have multiple attractors (noise-induced transitions). For many analytical purposes, deterministic approximations suffice, but understanding the stochastic nature is essential for interpreting experimental variability.</Body>

  <FlashCard id="fc3">
    <Front>What distinguishes stochastic from deterministic dynamical systems?</Front>
    <Back>Deterministic systems have a unique trajectory for each initial condition (future is fully determined). Stochastic systems include random fluctuations (noise), so identical initial conditions can produce different trajectories. SDEs take the form: dx = f(x)dt + g(x)dW.</Back>
  </FlashCard>

  <SingleSelect id="q1">
    <Prompt>A neuroscientist records membrane potential from a neuron and observes slight variations in spike timing across repeated identical stimulations. Which type of dynamical system best describes this observation?</Prompt>
    <Options>
      <Option>Deterministic system with time-varying parameters</Option>
      <Option correct="true">Stochastic system with noise-driven variability</Option>
      <Option>Deterministic system with chaotic dynamics</Option>
      <Option>Deterministic system with multiple stable attractors</Option>
    </Options>
  </SingleSelect>

  <H2>Attractors and Their Types</H2>

  <Body>An attractor is a set of states toward which nearby trajectories converge as time approaches infinity. Attractors represent the long-term behavior of a dynamical system and are fundamental to understanding neuronal dynamics.</Body>

  <H3>Fixed Point Attractors</H3>

  <Body>A fixed point (or equilibrium point) x* satisfies f(x*) = 0, meaning the system remains stationary there. A fixed point is stable (attracting) if small perturbations decay back to it, and unstable (repelling) if small perturbations grow away from it.</Body>

  <Body>For a 1D system dx/dt = f(x), stability is determined by the derivative: if f'(x*) is less than 0, the fixed point is stable; if f'(x*) is greater than 0, it is unstable. In higher dimensions, stability depends on the eigenvalues of the Jacobian matrix evaluated at the fixed point.</Body>

  <Code lang="python">
# Stability analysis for 1D linear system
# dV/dt = -(V - V_rest)/tau = f(V)
# f'(V) = -1/tau &lt; 0 for tau &gt; 0
# Therefore V_rest is a stable fixed point

import numpy as np
import matplotlib.pyplot as plt

def f(V, V_rest=-70, tau=10):
    """Vector field for passive membrane equation."""
    return -(V - V_rest) / tau

# Plot the vector field
V_values = np.linspace(-100, -40, 100)
dV_dt = f(V_values)

plt.figure(figsize=(10, 5))
plt.plot(V_values, dV_dt, 'b-', linewidth=2)
plt.axhline(y=0, color='k', linestyle='-', linewidth=0.5)
plt.axvline(x=-70, color='r', linestyle='--', label='Fixed point V*=-70mV')
plt.fill_between(V_values, dV_dt, 0, where=(dV_dt &gt; 0), alpha=0.3, color='green', label='dV/dt &gt; 0 (V increasing)')
plt.fill_between(V_values, dV_dt, 0, where=(dV_dt &lt; 0), alpha=0.3, color='red', label='dV/dt &lt; 0 (V decreasing)')
plt.xlabel('Membrane Potential V (mV)')
plt.ylabel('dV/dt (mV/ms)')
plt.title('Vector Field Analysis: Arrows Show Flow Direction')
plt.legend()
plt.grid(True)
plt.show()
  </Code>

  <H3>Limit Cycle Attractors</H3>

  <Body>A limit cycle is a closed trajectory in state space that attracts nearby trajectories. Systems with limit cycle attractors exhibit sustained oscillations. Many neurons display rhythmic firing patterns that can be modeled as limit cycles, such as pacemaker neurons in the heart or respiratory centers in the brainstem.</Body>

  <H3>Strange Attractors</H3>

  <Body>Strange attractors occur in chaotic systems and have fractal geometry. Trajectories on a strange attractor are bounded but never repeat exactly, displaying sensitive dependence on initial conditions. While less common in single-neuron models, chaotic dynamics can emerge in neural networks and may play roles in neural computation.</Body>

  <FlashCard id="fc4">
    <Front>What is a fixed point attractor and how do you determine its stability in 1D?</Front>
    <Back>A fixed point x* satisfies f(x*) = 0. It is a fixed point attractor (stable) if nearby trajectories converge to it. In 1D, stability is determined by the sign of f'(x*): negative means stable, positive means unstable.</Back>
  </FlashCard>

  <MultiSelect id="q2">
    <Prompt>Which of the following are types of attractors in dynamical systems theory? Select all that apply.</Prompt>
    <Options>
      <Option correct="true">Fixed point</Option>
      <Option correct="true">Limit cycle</Option>
      <Option>Nullcline</Option>
      <Option correct="true">Strange attractor</Option>
    </Options>
  </MultiSelect>

  <H2>Attractive Basins and Initial Condition Sensitivity</H2>

  <Body>The basin of attraction of an attractor is the set of all initial conditions whose trajectories converge to that attractor. Understanding basins is crucial because they determine how neurons respond to perturbations.</Body>

  <Body>For a simple stable fixed point like the resting potential, the basin of attraction may be the entire state space (global attractor). However, many neuronal models have multiple attractors, and the basins partition the state space into distinct regions with different long-term behaviors.</Body>

  <Code lang="python">
import numpy as np
import matplotlib.pyplot as plt

# Example: Bistable system with two stable fixed points
# dV/dt = V(V - 0.5)(1 - V) has fixed points at V=0, V=0.5, V=1
# V=0 and V=1 are stable; V=0.5 is unstable

def bistable_f(V):
    """Bistable vector field."""
    return V * (V - 0.5) * (1 - V)

V_values = np.linspace(-0.2, 1.2, 200)
dV_dt = bistable_f(V_values)

plt.figure(figsize=(10, 5))
plt.plot(V_values, dV_dt, 'b-', linewidth=2)
plt.axhline(y=0, color='k', linestyle='-', linewidth=0.5)

# Mark fixed points
plt.plot([0, 0.5, 1], [0, 0, 0], 'ro', markersize=10)
plt.annotate('Stable', (0, 0.01), ha='center')
plt.annotate('Unstable', (0.5, 0.01), ha='center')
plt.annotate('Stable', (1, 0.01), ha='center')

# Show basins
plt.fill_between(V_values, -0.1, 0.1, where=(V_values &lt; 0.5), alpha=0.2, color='blue', label='Basin of V=0')
plt.fill_between(V_values, -0.1, 0.1, where=(V_values &gt; 0.5), alpha=0.2, color='green', label='Basin of V=1')

plt.xlabel('V')
plt.ylabel('dV/dt')
plt.title('Bistable System: Two Attractors with Separate Basins')
plt.legend()
plt.grid(True)
plt.ylim(-0.1, 0.1)
plt.show()
  </Code>

  <Body>In this bistable example, the unstable fixed point at V = 0.5 acts as a threshold separating two basins of attraction. Initial conditions below 0.5 converge to V = 0, while those above 0.5 converge to V = 1. This threshold behavior is analogous to the firing threshold in neurons: perturbations below threshold decay back to rest, while suprathreshold perturbations trigger a qualitatively different response.</Body>

  <SingleSelect id="q3">
    <Prompt>In a bistable neuronal system with stable fixed points at V = -70 mV (rest) and V = +20 mV (depolarized), and an unstable fixed point at V = -50 mV, what happens to a neuron initialized at V = -55 mV?</Prompt>
    <Options>
      <Option correct="true">It converges to V = -70 mV (resting state)</Option>
      <Option>It converges to V = +20 mV (depolarized state)</Option>
      <Option>It remains at V = -55 mV indefinitely</Option>
      <Option>It oscillates between the two stable states</Option>
    </Options>
  </SingleSelect>

  <H2>Biological Interpretation: Resting Potential as Fixed Point Attractor</H2>

  <Body>The resting membrane potential is perhaps the most fundamental example of a fixed point attractor in neuroscience. At rest, the neuron maintains a stable voltage (typically around -70 mV in mammalian neurons) through the balance of ionic currents.</Body>

  <Body>The passive membrane equation provides a simple model:</Body>

  <Code lang="plaintext">
C dV/dt = -g_L(V - V_rest) + I_ext
  </Code>

  <Body>Without external input (I_ext = 0), this simplifies to:</Body>

  <Code lang="plaintext">
tau * dV/dt = -(V - V_rest)
  </Code>

  <Body>where tau = C/g_L is the membrane time constant. The unique fixed point is V* = V_rest, and it is globally stable because f'(V*) = -1/tau is less than 0 for positive tau.</Body>

  <Body>The analytical solution is:</Body>

  <Code lang="plaintext">
V(t) = V_rest + (V_0 - V_rest) * exp(-t/tau)
  </Code>

  <Body>This exponential decay describes how the membrane potential returns to rest after any perturbation, with the time constant tau determining the speed of return. This stability is essential for neural function: without it, neurons could not maintain the precise resting state from which action potentials are generated.</Body>

  <Code lang="python">
import numpy as np
import matplotlib.pyplot as plt

# Analytical solution for passive membrane
def analytical_solution(V0, V_rest, tau, t):
    """Exact solution: V(t) = V_rest + (V0 - V_rest)*exp(-t/tau)"""
    return V_rest + (V0 - V_rest) * np.exp(-t / tau)

# Parameters
V_rest = -70  # mV
tau = 10      # ms

t = np.linspace(0, 50, 500)

# Different initial conditions
initial_conditions = [-90, -80, -60, -50, -40]

plt.figure(figsize=(12, 5))

# Left: Time series
plt.subplot(1, 2, 1)
for V0 in initial_conditions:
    V = analytical_solution(V0, V_rest, tau, t)
    plt.plot(t, V, linewidth=2, label=f'V(0) = {V0} mV')

plt.axhline(y=V_rest, color='k', linestyle='--', linewidth=1)
plt.xlabel('Time (ms)')
plt.ylabel('Membrane Potential (mV)')
plt.title('Trajectories: Exponential Convergence to V_rest')
plt.legend()
plt.grid(True)

# Right: Phase portrait (1D)
plt.subplot(1, 2, 2)
V_range = np.linspace(-100, -40, 100)
dV_dt = -(V_range - V_rest) / tau

plt.plot(V_range, dV_dt, 'b-', linewidth=2)
plt.axhline(y=0, color='k', linestyle='-', linewidth=0.5)
plt.plot(V_rest, 0, 'ro', markersize=12, label='Stable fixed point')

# Add arrows showing flow
arrow_positions = [-95, -85, -75, -65, -55, -45]
for V_pos in arrow_positions:
    direction = 1 if V_pos &lt; V_rest else -1
    plt.annotate('', xy=(V_pos + direction*3, 0), xytext=(V_pos, 0),
                arrowprops=dict(arrowstyle='-&gt;', color='green', lw=2))

plt.xlabel('Membrane Potential V (mV)')
plt.ylabel('dV/dt (mV/ms)')
plt.title('Phase Portrait: Flow Toward Attractor')
plt.legend()
plt.grid(True)

plt.tight_layout()
plt.show()
  </Code>

  <MatchPairs id="q4">
    <Prompt>Match each dynamical systems concept to its neurobiological interpretation:</Prompt>
    <Pairs>
      <Pair><Left>Fixed point attractor</Left><Right>Resting membrane potential</Right></Pair>
      <Pair><Left>Limit cycle attractor</Left><Right>Rhythmic firing (pacemaker neurons)</Right></Pair>
      <Pair><Left>Basin of attraction</Left><Right>Range of initial voltages returning to rest</Right></Pair>
      <Pair><Left>Unstable fixed point</Left><Right>Firing threshold</Right></Pair>
    </Pairs>
    <RightDistractors>
      <Distractor>Action potential amplitude</Distractor>
      <Distractor>Synaptic weight</Distractor>
    </RightDistractors>
  </MatchPairs>

  <H2>Phase Portraits and Geometric Analysis</H2>

  <Body>A phase portrait is a graphical representation of trajectories in state space. For 1D systems, the phase portrait is simply a plot of dx/dt versus x, showing the flow direction at each point. For 2D systems, phase portraits become much richer, displaying nullclines, fixed points, and the characteristic shapes of different attractor types.</Body>

  <Body>Nullclines are curves where one component of the vector field vanishes. In a 2D system with variables x and y, the x-nullcline is defined by dx/dt = 0, and the y-nullcline by dy/dt = 0. Fixed points occur at intersections of nullclines, and the nullcline geometry determines the qualitative behavior of the system.</Body>

  <Code lang="python">
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

# 2D linear system example (stable node)
# dx/dt = -x + 0.5*y
# dy/dt = 0.5*x - y

def linear_2d(state, t):
    x, y = state
    dxdt = -x + 0.5*y
    dydt = 0.5*x - y
    return [dxdt, dydt]

# Create meshgrid for vector field
x_range = np.linspace(-3, 3, 20)
y_range = np.linspace(-3, 3, 20)
X, Y = np.meshgrid(x_range, y_range)

# Compute vector field
U = -X + 0.5*Y
V = 0.5*X - Y

plt.figure(figsize=(10, 8))

# Plot vector field
plt.quiver(X, Y, U, V, alpha=0.5)

# Plot nullclines
x_dense = np.linspace(-3, 3, 100)
y_nullcline_x = 0.5 * x_dense  # x-nullcline: y = 2x
x_nullcline_y = 2 * x_dense     # y-nullcline: x = 2y, so y = x/2

plt.plot(x_dense, 2*x_dense, 'r-', linewidth=2, label='x-nullcline (dx/dt=0)')
plt.plot(x_dense, 0.5*x_dense, 'b-', linewidth=2, label='y-nullcline (dy/dt=0)')

# Plot trajectories from various initial conditions
t = np.linspace(0, 10, 1000)
initial_conditions_2d = [
    (2, 2), (-2, 2), (2, -2), (-2, -2),
    (3, 0), (-3, 0), (0, 3), (0, -3)
]

for ic in initial_conditions_2d:
    trajectory = odeint(linear_2d, ic, t)
    plt.plot(trajectory[:, 0], trajectory[:, 1], 'g-', linewidth=1, alpha=0.7)
    plt.plot(ic[0], ic[1], 'go', markersize=5)

# Mark fixed point
plt.plot(0, 0, 'ko', markersize=12, label='Stable fixed point')

plt.xlim(-3, 3)
plt.ylim(-3, 3)
plt.xlabel('x')
plt.ylabel('y')
plt.title('2D Phase Portrait: Stable Node at Origin')
plt.legend()
plt.grid(True)
plt.axis('equal')
plt.show()
  </Code>

  <Body>The phase portrait above shows a stable node: all trajectories spiral or flow directly toward the fixed point at the origin. The nullclines divide the phase plane into regions where the flow has different characteristics. By analyzing the sign of each derivative in each region, we can determine the flow direction without solving the equations explicitly.</Body>

  <H2>Numerical Simulation of Trajectories</H2>

  <Body>While analytical solutions exist for linear systems, most neuronal models require numerical integration. The simplest method is Euler's method:</Body>

  <Code lang="python">
import numpy as np
import matplotlib.pyplot as plt

def euler_integrate(f, x0, t_span, dt, params=None):
    """
    Euler method for numerical integration.

    Parameters:
    -----------
    f : function
        Vector field f(x, params) returning dx/dt
    x0 : float or array
        Initial condition
    t_span : tuple
        (t_start, t_end)
    dt : float
        Time step
    params : dict, optional
        Parameters to pass to f

    Returns:
    --------
    t : array
        Time points
    x : array
        Solution trajectory
    """
    t = np.arange(t_span[0], t_span[1], dt)
    x = np.zeros((len(t), np.size(x0)))
    x[0] = x0

    for i in range(1, len(t)):
        if params:
            dx = f(x[i-1], params)
        else:
            dx = f(x[i-1])
        x[i] = x[i-1] + dx * dt

    return t, x

# Example: passive membrane with step current input
def passive_membrane(V, params):
    """dV/dt = (-(V - V_rest) + R*I) / tau"""
    V_rest = params['V_rest']
    tau = params['tau']
    R = params['R']
    I = params['I']
    return (-(V - V_rest) + R * I) / tau

params = {
    'V_rest': -70,  # mV
    'tau': 10,      # ms
    'R': 10,        # MOhm
    'I': 0          # nA (no input initially)
}

# Simulate with step current
t1, V1 = euler_integrate(passive_membrane, np.array([-70]), (0, 50), 0.1, params)

# Now add current pulse
params['I'] = 2  # nA
t2, V2 = euler_integrate(passive_membrane, V1[-1], (50, 150), 0.1, params)

# Turn off current
params['I'] = 0
t3, V3 = euler_integrate(passive_membrane, V2[-1], (150, 250), 0.1, params)

# Concatenate results
t_full = np.concatenate([t1, t2, t3])
V_full = np.concatenate([V1, V2, V3])

plt.figure(figsize=(12, 5))

plt.subplot(1, 2, 1)
plt.plot(t_full, V_full, 'b-', linewidth=2)
plt.axhline(y=-70, color='k', linestyle='--', alpha=0.5, label='V_rest')
plt.axvline(x=50, color='r', linestyle=':', alpha=0.5)
plt.axvline(x=150, color='r', linestyle=':', alpha=0.5)
plt.xlabel('Time (ms)')
plt.ylabel('Membrane Potential (mV)')
plt.title('Response to Current Pulse')
plt.legend()
plt.grid(True)

# Current input
plt.subplot(1, 2, 2)
I_input = np.zeros_like(t_full)
I_input[(t_full &gt;= 50) &amp; (t_full &lt; 150)] = 2
plt.plot(t_full, I_input, 'r-', linewidth=2)
plt.xlabel('Time (ms)')
plt.ylabel('Input Current (nA)')
plt.title('Applied Current')
plt.grid(True)

plt.tight_layout()
plt.show()
  </Code>

  <Body>The simulation demonstrates the fundamental behavior: when current is applied, the membrane potential rises toward a new equilibrium; when current is removed, it returns exponentially to rest. This is the attractor dynamics in action.</Body>

  <FillBlanks id="q5">
    <Prompt>
      In the passive membrane equation dV/dt = -(V - V_rest)/tau, the parameter tau is called the membrane <Blank>time constant</Blank>. When V is greater than V_rest, the derivative dV/dt is <Blank>negative</Blank>, causing V to <Blank>decrease</Blank> toward V_rest.
    </Prompt>
    <Distractors>
      <Distractor>positive</Distractor>
      <Distractor>increase</Distractor>
      <Distractor>space constant</Distractor>
      <Distractor>conductance</Distractor>
    </Distractors>
  </FillBlanks>

  <H2>Summary: Key Concepts</H2>

  <Body>This lesson has introduced the dynamical systems framework that underlies all neuronal modeling. The key concepts form a hierarchy of understanding:</Body>

  <Body>DYNAMICAL SYSTEM: A mathematical rule (differential equation) governing how state evolves over time. For neurons, this typically describes how membrane potential changes based on ionic currents and inputs.</Body>

  <Body>STATE SPACE: The set of all possible states. Understanding the geometry of state space reveals the possible behaviors of the system.</Body>

  <Body>TRAJECTORY: The path a system follows through state space from a given initial condition. Trajectories show how neurons respond to perturbations.</Body>

  <Body>ATTRACTOR: A set toward which trajectories converge. Fixed points (like resting potential), limit cycles (rhythmic firing), and strange attractors (chaotic dynamics) are the three main types.</Body>

  <Body>BASIN OF ATTRACTION: The set of initial conditions converging to a particular attractor. Basins determine how neurons respond to different magnitudes of perturbation.</Body>

  <Body>DETERMINISTIC VS. STOCHASTIC: Real neurons include noise; the choice of model depends on whether noise significantly affects the phenomena of interest.</Body>

  <SortQuiz id="q6">
    <Prompt>Order the following steps for analyzing a 1D dynamical system from first to last:</Prompt>
    <SortedItems>
      <Item>Write the differential equation dx/dt = f(x)</Item>
      <Item>Find fixed points by solving f(x*) = 0</Item>
      <Item>Compute f'(x*) to determine stability</Item>
      <Item>Sketch the phase portrait showing flow directions</Item>
      <Item>Identify basins of attraction for each stable fixed point</Item>
    </SortedItems>
  </SortQuiz>

  <H2>Connecting to Experiments</H2>

  <Body>The dynamical systems framework connects directly to experimental neuroscience. Intracellular recordings measure trajectories in voltage space. Current-clamp experiments probe the response to perturbations, revealing the structure of basins. Subthreshold responses demonstrate the attractive nature of resting potential, while suprathreshold responses show transitions to different dynamical regimes.</Body>

  <Body>In subsequent lessons, we will build on this foundation to analyze more complex models: the integrate-and-fire model introduces threshold dynamics, the Hodgkin-Huxley model explains the biophysical mechanisms underlying action potentials, and the FitzHugh-Nagumo model reveals the geometric structure of excitability through nullcline analysis.</Body>

  <FlashCard id="fc5">
    <Front>What is a basin of attraction?</Front>
    <Back>The basin of attraction of an attractor is the set of all initial conditions whose trajectories converge to that attractor as time approaches infinity. It defines the region of state space from which the system will evolve toward a particular long-term behavior.</Back>
  </FlashCard>

  <FlashCard id="fc6">
    <Front>What is a nullcline and why are they important in 2D systems?</Front>
    <Back>A nullcline is a curve in phase space where one component of the derivative is zero. In 2D systems, fixed points occur at intersections of nullclines, and nullcline geometry determines the qualitative behavior of the system, making them essential for geometric analysis.</Back>
  </FlashCard>

  <Subjective id="q7">
    <Prompt>Explain why the resting membrane potential of a neuron can be understood as a stable fixed point attractor. In your answer, describe what makes it an attractor, how you would verify its stability mathematically, and what the biological significance of this stability is for neuronal function.</Prompt>
    <Rubric>
      <Criterion points="3" required="true">
        <Requirement>Explains that resting potential is a fixed point because dV/dt = 0 when V = V_rest (equilibrium condition)</Requirement>
        <Indicators>equilibrium, dV/dt = 0, no change, stationary, fixed point</Indicators>
      </Criterion>
      <Criterion points="3" required="true">
        <Requirement>Describes attractor property: trajectories from nearby initial conditions converge to V_rest</Requirement>
        <Indicators>converge, attract, return, nearby, trajectories approach</Indicators>
      </Criterion>
      <Criterion points="2">
        <Requirement>Provides mathematical stability criterion: f'(V_rest) is negative, or explains linearization approach</Requirement>
        <Indicators>derivative, f'(V*), negative, linearization, eigenvalue, stability analysis</Indicators>
      </Criterion>
      <Criterion points="2">
        <Requirement>Discusses biological significance: neurons must maintain stable resting state to generate reliable responses to inputs</Requirement>
        <Indicators>reliable, consistent, baseline, ready to fire, homeostasis, function</Indicators>
      </Criterion>
    </Rubric>
    <Constraints minWords="50" maxWords="300" />
  </Subjective>

  <H2>Common Misconceptions</H2>

  <Body>As you continue your study, be aware of these common errors:</Body>

  <Body>MISCONCEPTION 1: All equilibrium points are attractors. This is false. An equilibrium (fixed point) simply means dV/dt = 0 at that point. Whether it attracts nearby trajectories depends on stability analysis. Unstable equilibria repel trajectories.</Body>

  <Body>MISCONCEPTION 2: All neuronal models have unique attractors. Many interesting models are bistable or multistable, with multiple coexisting attractors. The neuron's long-term behavior then depends critically on initial conditions or the history of inputs.</Body>

  <Body>MISCONCEPTION 3: Initial conditions do not matter for long-term behavior. While trajectories in the same basin of attraction converge to the same attractor, different basins lead to different long-term states. Initial conditions determine which attractor the system reaches.</Body>

  <MultiSelect id="q8">
    <Prompt>Which of the following statements about fixed points are TRUE? Select all that apply.</Prompt>
    <Options>
      <Option correct="true">A fixed point satisfies f(x*) = 0</Option>
      <Option>All fixed points are stable attractors</Option>
      <Option correct="true">Stability can be determined by the sign of f'(x*) in 1D systems</Option>
      <Option correct="true">An unstable fixed point can separate basins of attraction</Option>
    </Options>
  </MultiSelect>

</Lesson>
